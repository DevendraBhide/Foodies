<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cart</title>
    <%-include('../cdn.ejs')%>
</head>

<body>
  <%-include('navbar.ejs')%>
      <br>

      <table class="table table-bordered">
        <tr class="text-center">
            <th>Sr.No</th>
            <th>Name</th>
            <th>Price</th>
            <th>Image</th>
            <th>Quantity</th>
            <th><div class="bi bi-bag"></div></th>
            <!-- <th><button type="button" class="btn-close" aria-label="Close"></button></th> -->
             <th><div class="bi bi-x-lg"></div></th>
        </tr>
        
        <% data.map((val,index)=>{ %>
          <tr class="text-center">
            <td><%=index+1%></td>
            <td><%=val.p_name%></td>
            <td id="price-<%=val.p_id%>"><%=val.p_price%></td>
            <td><%=val.p_image%></td>
            <td><div class="input-group" style="width: 120px;">
              <button class="btn btn-outline-secondary" onclick="updateCount('<%= val.p_id %>', -1)">-</button>
              <input type="text" id="qty-<%= val.p_id %>" value="1" class="form-control text-center" readonly>
              <button class="btn btn-outline-secondary" onclick="updateCount('<%= val.p_id %>', 1)">+</button>
          </div>
          </td>
            <td><a class="text-decoration-none text-warning fw-bold btn" href="/buying/<%=val.p_id%>">Buy Now</a></td>
            <td><a href="/remove/<%-val.p_id%>" class="btn btn-danger">remove</a></td>
          </tr>
     <%   })%>
          
            
      </table>
      <%-include("footer.ejs")%>

      <script>
  function updateCount(id, change) {
    const input = document.getElementById(`qty-${id}`);
    const price=document.getElementById(`price-${id}`);
    let current = parseInt(input.value);
    if (current + change >= 1) {
      input.value = current + change;
      return input.value;
      price.value=price.value * input.value;
      price.innerText=price;
    }

  }
</script>

</body>
</html>